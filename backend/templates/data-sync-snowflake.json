{
  "id": "data-sync-snowflake",
  "title": "Data: Sync to Snowflake",
  "description": "Export transformed data and load into Snowflake warehouse, validate row counts and notify BI team.",
  "category": "Data",
  "tags": ["data", "warehouse", "snowflake"],
  "sample_input": {"table": "events"},
  "graph": {
    "nodes": [
      {"id": "in", "type": "input", "position": {"x": 0, "y": 0}, "data": {"label": "Manual Trigger"}},
      {"id": "export", "type": "action", "position": {"x": 220, "y": 0}, "data": {"label": "Export Data", "config": {"language": "python", "code": "# export to CSV and upload to stage\nreturn {'rows':1000}"}}},
      {"id": "load", "type": "http", "position": {"x": 440, "y": 0}, "data": {"label": "Load to Snowflake", "config": {"method": "POST", "url": "https://snowflake.api/load", "body": "{{ node_results.export }}"}}},
      {"id": "validate", "type": "action", "position": {"x": 660, "y": 0}, "data": {"label": "Validate Row Counts", "config": {"language": "python", "code": "# compare expected vs loaded\nreturn {'ok': True}"}}},
      {"id": "notify", "type": "http", "position": {"x": 880, "y": 0}, "data": {"label": "Notify BI", "config": {"method": "POST", "url": "https://hooks.slack.com/services/...", "body": "Loaded {{ node_results.export.rows }} rows"}}}
    ],
    "edges": [
      {"id": "e1", "source": "in", "target": "export"},
      {"id": "e2", "source": "export", "target": "load"},
      {"id": "e3", "source": "load", "target": "validate"},
      {"id": "e4", "source": "validate", "target": "notify"}
    ]
  }
}