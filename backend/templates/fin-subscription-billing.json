{
  "id": "fin-subscription-billing",
  "title": "Finance: Subscription Billing",
  "description": "Run recurring billing for subscriptions, handle failed payments and notify customers.",
  "category": "Finance",
  "tags": ["finance", "billing", "subscriptions"],
  "sample_input": {"billing_date": "2025-08-01"},
  "graph": {
    "nodes": [
      {"id": "in", "type": "input", "position": {"x": 0, "y": 0}, "data": {"label": "Scheduled"}},
      {"id": "fetch_subs", "type": "http", "position": {"x": 220, "y": 0}, "data": {"label": "Fetch due subs", "config": {"method": "GET", "url": "https://billing.api/subscriptions?due={{ trigger.billing_date }}"}}},
      {"id": "charge", "type": "http", "position": {"x": 440, "y": 0}, "data": {"label": "Charge", "config": {"method": "POST", "url": "https://payments.api/charge", "body": "{{ node_results.fetch_subs }}"}}},
      {"id": "handle_failed", "type": "action", "position": {"x": 660, "y": 0}, "data": {"label": "Handle failures", "config": {"language": "python", "code": "# retry logic placeholder\\nreturn {'retries': []}"}}},
      {"id": "notify", "type": "http", "position": {"x": 880, "y": 0}, "data": {"label": "Notify customers", "config": {"method": "POST", "url": "https://email.api/bulk", "body": "{{ node_results.handle_failed }}"}}}
    ],
    "edges": [
      {"id": "e1", "source": "in", "target": "fetch_subs"},
      {"id": "e2", "source": "fetch_subs", "target": "charge"},
      {"id": "e3", "source": "charge", "target": "handle_failed"},
      {"id": "e4", "source": "handle_failed", "target": "notify"}
    ]
  }
}
