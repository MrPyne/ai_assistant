{
  "id": "procurement-po-fulfillment-check",
  "title": "Procurement: PO Fulfillment Check",
  "description": "Validate that POs have been fulfilled by suppliers and close POs or escalate if overdue.",
  "category": "Procurement",
  "tags": ["procurement", "po", "fulfillment"],
  "sample_input": {"po_id": "PO-400"},
  "graph": {
    "nodes": [
      {
        "id": "in",
        "type": "input",
        "position": {"x": 0, "y": 0},
        "data": {"label": "Scheduler"}
      },
      {
        "id": "fetch_po",
        "type": "http",
        "position": {"x": 220, "y": 0},
        "data": {
          "label": "Get PO",
          "config": {"method": "GET", "url": "https://proc.api/pos/{{ trigger.po_id }}"}
        }
      },
      {
        "id": "check_fulfillment",
        "type": "action",
        "position": {"x": 440, "y": 0},
        "data": {
          "label": "Check Fulfillment",
          "config": {
            "language": "python",
            "code": "po = json.loads(input.get('body','{}'));\\nif not po.get('fulfilled'):\\n    return {'overdue': True}\\nreturn {'overdue': False}"
          }
        }
      },
      {
        "id": "close_po",
        "type": "http",
        "position": {"x": 660, "y": 0},
        "data": {
          "label": "Close PO",
          "config": {"method": "POST", "url": "https://proc.api/pos/{{ trigger.po_id }}/close"}
        }
      },
      {
        "id": "escalate",
        "type": "http",
        "position": {"x": 660, "y": 120},
        "data": {
          "label": "Escalate",
          "config": {"method": "POST", "url": "https://hooks.slack.com/services/...", "body": "PO {{ trigger.po_id }} overdue"}
        }
      }
    ],
    "edges": [
      {"id": "e1", "source": "in", "target": "fetch_po"},
      {"id": "e2", "source": "fetch_po", "target": "check_fulfillment"},
      {"id": "e3", "source": "check_fulfillment", "target": "close_po"},
      {"id": "e4", "source": "check_fulfillment", "target": "escalate"}
    ]
  }
}
