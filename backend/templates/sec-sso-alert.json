{
  "id": "sec-sso-alert",
  "title": "Security: SSO Login Alert",
  "description": "Detect logins from new locations/devices and notify security team.",
  "category": "Security",
  "tags": ["security","sso","alerting"],
  "sample_input": {"user":"u-1","ip":"8.8.8.8"},
  "graph": {
    "nodes": [
      {"id": "in", "type": "input", "position": {"x": 0, "y": 0}, "data": {"label": "Auth event"}},
      {"id": "geo", "type": "http", "position": {"x": 220, "y": 0}, "data": {"label": "GeoIP", "config": {"method": "GET", "url": "https://geo.api/{{ trigger.ip }}"}}},
      {"id": "check", "type": "action", "position": {"x": 440, "y": 0}, "data": {"label": "Check unusual", "config": {"language": "python", "code": "if node_results.geo.get('country') != 'US':\\n    return {'notify': True}\\nreturn {'notify': False}"}}},
      {"id": "notify", "type": "http", "position": {"x": 660, "y": 0}, "data": {"label": "Notify Sec", "config": {"method": "POST", "url": "https://slack.api/post", "body": "Unusual login: {{ trigger.user }} from {{ node_results.geo }}"}}}
    ],
    "edges": [
      {"id": "e1", "source": "in", "target": "geo"},
      {"id": "e2", "source": "geo", "target": "check"},
      {"id": "e3", "source": "check", "target": "notify"}
    ]
  }
}
