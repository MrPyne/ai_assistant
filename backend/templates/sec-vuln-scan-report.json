{
  "id": "sec-vuln-scan-report",
  "title": "Security: Vulnerability Scan Report",
  "description": "Run scheduled vuln scans, aggregate findings, prioritize by severity and notify security Slack channel with summary and ticket creation.",
  "category": "Security",
  "tags": ["security","vuln","slack"],
  "sample_input": {"scan_id":"scan-2025-10"},
  "graph": {"nodes":[{"id":"in","type":"input","position":{"x":0,"y":0},"data":{"label":"Scheduler"}},{"id":"run_scan","type":"http","position":{"x":220,"y":0},"data":{"label":"Run Scanner","config":{"method":"POST","url":"https://scanner.local/api/run","body":"{\"target\":\"all\"}"}}},{"id":"aggregate","type":"action","position":{"x":440,"y":0},"data":{"label":"Aggregate Findings","config":{"language":"python","code":"findings = json.loads(input.get('body','[]'))\nby_sev = {}\nfor f in findings:\n    s = f.get('severity','medium')\n    by_sev.setdefault(s,[]).append(f)\nreturn {'by_sev': by_sev}"}}},{"id":"notify","type":"http","position":{"x":660,"y":0},"data":{"label":"Notify Slack","config":{"method":"POST","url":"https://hooks.slack.com/services/...","body":"Vuln scan completed: critical={{ node_results.aggregate.by_sev.critical|length }}"}}}],"edges":[{"id":"e1","source":"in","target":"run_scan"},{"id":"e2","source":"run_scan","target":"aggregate"},{"id":"e3","source":"aggregate","target":"notify"}]}
}