{
  "id": "support-chatbot-handoff",
  "title": "Support: Chatbot Handoff",
  "description": "When chatbot confidence is low, create a ticket and hand off to a human agent.",
  "category": "Support",
  "tags": ["support", "chatbot", "handoff"],
  "sample_input": {"conversation_id": "conv-1", "confidence": 0.45},
  "graph": {
    "nodes": [
      {
        "id": "in",
        "type": "input",
        "position": {"x": 0, "y": 0},
        "data": {"label": "Chat event"}
      },
      {
        "id": "check_confidence",
        "type": "action",
        "position": {"x": 220, "y": 0},
        "data": {
          "label": "Check confidence",
          "config": {
            "language": "python",
            "code": "if trigger.get(\"confidence\", 1) < 0.6:\n  return {\"handoff\": True}\nreturn {\"handoff\": False}"
          }
        }
      },
      {
        "id": "create_ticket",
        "type": "http",
        "position": {"x": 440, "y": 0},
        "data": {
          "label": "Create ticket",
          "config": {"method": "POST", "url": "https://support.api/tickets", "body": "{{ trigger }}"}
        }
      },
      {
        "id": "notify_agent",
        "type": "http",
        "position": {"x": 660, "y": 0},
        "data": {
          "label": "Notify agent",
          "config": {"method": "POST", "url": "https://slack.api/post", "body": "New ticket created"}
        }
      }
    ],
    "edges": [
      {"id": "e1", "source": "in", "target": "check_confidence"},
      {"id": "e2", "source": "check_confidence", "target": "create_ticket"},
      {"id": "e3", "source": "create_ticket", "target": "notify_agent"}
    ]
  }
}
